<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Invoice</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #555; padding: 20px; }
        .invoice-paper {
            background: white;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            min-height: 1000px;
        }
        @media print {
            body { background: white; padding: 0; }
            .no-print { display: none; }
        }
    </style>
</head>
<body>

<div class="text-center mb-3 no-print">
    <button onclick="window.print()" class="btn btn-light">üñ®Ô∏è Print</button>
</div>

<div class="invoice-paper">

    <!-- Header -->
    <div class="d-flex justify-content-between border-bottom pb-4 mb-4">
        <h1>INVOICE</h1>
        <div class="text-end">
            {% if business %}
                <h4>{{ business.business_name }}</h4>
                <p class="mb-1">{{ business.address }}</p>
                <p class="mb-1">Phone: {{ business.phone }}</p>
                <p class="mb-0">GSTIN: {{ business.gstin }}</p>
            {% else %}
                <h4>StudioBase</h4>
                <p class="text-muted">Business profile not configured</p>
            {% endif %}
        </div>
    </div>

    <!-- Client + Meta -->
    <div class="row mb-5">
        <div class="col-6">
            <h6>Bill To</h6>
            <h4>{{ invoice.client_name }}</h4>
            <p class="mb-2">{{ invoice.project_title }}</p>

            <span class="badge {% if invoice.status == 'Paid' %}bg-success{% else %}bg-danger{% endif %}">
                {{ invoice.status }}
            </span>
        </div>

        <div class="col-6 text-end">
            <p><strong>Invoice #:</strong> {{ invoice.invoice_number }}</p>
            <p><strong>Issued:</strong> {{ invoice.created_at | date_format }}</p>
            <p><strong>Due:</strong> {{ invoice.due_date | date_format }}</p>
            <p><strong>Payment Mode:</strong>
                {{ invoice.payment_mode | default("Not specified") }}
            </p>
        </div>
    </div>

    {% set gst = invoice.amount | gst %}

    <!-- Amount Table -->
    <table class="table table-bordered mb-4">
        <thead class="table-light">
            <tr>
                <th>Description</th>
                <th class="text-end">Amount (‚Çπ)</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td><strong>{{ invoice.project_title }}</strong></td>
                <td class="text-end">‚Çπ{{ gst.base | round(2) }}</td>
            </tr>
            <tr>
                <td class="text-end">CGST (9%)</td>
                <td class="text-end">‚Çπ{{ gst.cgst | round(2) }}</td>
            </tr>
            <tr>
                <td class="text-end">SGST (9%)</td>
                <td class="text-end">‚Çπ{{ gst.sgst | round(2) }}</td>
            </tr>
        </tbody>

        <tfoot class="table-light">
            <tr>
                <th class="text-end">Total Payable</th>
                <th class="text-end">‚Çπ{{ gst.total | round(2) }}</th>
            </tr>
        </tfoot>
    </table>

</div>
</body>
</html>
